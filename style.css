/* ================== THEME TOKENS (Dark por defecto) ================== */
:root{
  /* superficies y texto */
  --bg:#08090c; --bg-secondary:#0d0e12;
  --surface:#1a1c24; --surface-hover:#20222b; --surface-elevated:#242731; /* ← fix typo */
  --border:#2d3142; --border-subtle:#1e2029;
  --text-primary:#f8fafc; --text-secondary:#94a3b8; --text-muted:#64748b;

  /* acento */
  --accent:#ef4444; --accent-hover:#dc2626; --accent-light:#f87171;
  --dots:#ff6b6b;

  /* navegación / player */
  --dock-bg:#0b0a11;
  --mini-bg:rgba(11,10,17,1);
  --track-bg:rgba(255,255,255,.12);
  --nav-ink:#cbd5e1; --nav-ink-hover:#e5e7eb; --nav-ink-active:#ffffff;

  --title-size:14px; --subtitle-size:12px;

  --radius:16px; --radius-sm:12px; --side-pad:20px;

  --seek-h:72px; --nav-h:64px;
  --safe:env(safe-area-inset-bottom);

  --transition:all .3s cubic-bezier(.4,0,.2,1);
  --fast:all .15s ease-out;
}

/* ================== LIGHT THEME OVERRIDES ================== */
html[data-theme="light"]{
  color-scheme: light;
  --bg:#f6f7fb; --bg-secondary:#ffffff;
  --surface:#ffffff; --surface-hover:#f4f6fb; --surface-elevated:#ffffff;
  --border:#e5e7eb; --border-subtle:#eef2f7;
  --text-primary:#0f172a; --text-secondary:#334155; --text-muted:#64748b;

  --dock-bg:#ffffff;
  --mini-bg:#ffffff;
  --track-bg:rgba(0,0,0,.14);

  --nav-ink:#475569; --nav-ink-hover:#111827; --nav-ink-active:#111827;
}

html{color-scheme:dark; scroll-behavior: smooth;}
*{box-sizing:border-box}
body{
  margin:0;
  background:
    radial-gradient(circle at 20% 80%,rgba(59,130,246,.05)0%,transparent 50%),
    radial-gradient(circle at 80% 20%,rgba(139,92,246,.03)0%,transparent 50%),
    linear-gradient(135deg,var(--bg)0%,var(--bg-secondary)100%);
  color:var(--text-primary);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.muted{color:var(--text-muted)}
.up{ text-transform:uppercase; letter-spacing:.08em; font-weight:700; font-size:.7rem; }
.hide{display:none !important}

/* ——— Flotantes arriba ——— */
.logo-float{
  position:fixed; left:12px; top:12px; z-index:1200;
  width:36px; height:36px; border-radius:10px; object-fit:cover;
  border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06);
}

/* Lupa */
.search-fab{
  width:36px; height:36px; border-radius:18px; border:1px solid rgba(255,255,255,.1);
  display:grid; place-items:center; cursor:pointer; background:rgba(255,255,255,.06);
  color:#e5e7eb; transition:var(--fast); padding:0;
}
.search-fab svg,.search-fab path{ fill:currentColor; }
.search-fab:hover{background:rgba(255,255,255,.12); transform:translateY(-1px);}
.search-fab-global{ position:fixed; right:12px; top:12px; z-index:1200; backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px); }

/* Toggle de tema (CSS puro) */
.theme-toggle{
  position:fixed; right:56px; top:12px; z-index:1200;
  width:36px; height:36px; border-radius:18px;
  border:1px solid rgba(255,255,255,.1);
  background:rgba(255,255,255,.06);
  display:grid; place-items:center; cursor:pointer; transition:var(--fast);
  padding:0;
}
.theme-toggle:hover{background:rgba(255,255,255,.12); transform:translateY(-1px);}
.theme-toggle .ico{ width:18px; height:18px; position:relative; display:block; }
.theme-toggle .moon{ display:none; }

/* Sol y luna */
.theme-toggle .sun{
  border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #fde68a 0 55%, #f59e0b 56% 100%);
}
.theme-toggle .sun::before{
  content:""; position:absolute; inset:-5px; border-radius:50%;
  background: repeating-conic-gradient(#f59e0b 0 10deg, transparent 10deg 20deg);
  -webkit-mask: radial-gradient(circle 9px, transparent 8px, #000 8px);
          mask: radial-gradient(circle 9px, transparent 8px, #000 8px);
  opacity:.9;
}
.theme-toggle .moon{ border-radius:50%; background:#94a3b8; }
.theme-toggle .moon::after{
  content:""; position:absolute; left:6px; top:2px; width:14px; height:14px; border-radius:50%;
  background: var(--bg);
}
html[data-theme="light"] .theme-toggle .sun{ display:none; }
html[data-theme="light"] .theme-toggle .moon{ display:block; }

/* Overlay de búsqueda */
.search-overlay{ position:fixed; inset:0; display:none; z-index:1100; background:rgba(0,0,0,.45); backdrop-filter:blur(2px);}
.search-overlay.show{display:block;}
.search-card{
  position:absolute; left:12px; right:12px; top:14px;
  background:rgba(26,28,36,.95); border:1px solid rgba(255,255,255,.12);
  border-radius:14px; padding:10px 12px; box-shadow:0 8px 32px rgba(0,0,0,.35);
}
html[data-theme="light"] .search-card{ background:rgba(255,255,255,.98); border-color:var(--border); }
#overlaySearchInput{
  width:100%; background:rgba(36,39,49,.6); color:#fff;
  border:1px solid rgba(255,255,255,.08); border-radius:10px;
  padding:12px 14px; outline:none; font-size:15px;
}
html[data-theme="light"] #overlaySearchInput{ background:#f1f5f9; color:#0f172a; border-color:#e2e8f0; }
#overlaySearchInput:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(239,68,68,.1);}

/* ——— Vistas ——— */
.view{
  display:none;
  padding: var(--side-pad);
  padding-bottom: calc(var(--seek-h) + var(--nav-h) + 16px + var(--safe));
  animation: fadeIn .4s ease-in-out;
}
.view.active{display:block}
@keyframes fadeIn{ from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

/* Centro de listas */
:where(.results, .fav-list, #queueList, .pl-list, .fav-list-wrap, .queue-panel){
  max-width: 820px;
  margin-left: auto;
  margin-right: auto;
}

/* Filas comunes */
.results,.fav-list{display:flex;flex-direction:column;gap:0}
.fav-list, #queueList, .pl-list{ list-style:none; margin:0; padding:0; }
.result-item,.fav-item,.queue-item{
  display:flex;align-items:center;gap:14px;padding:12px 14px;cursor:pointer;
  transition:var(--fast);border-bottom:1px solid var(--border-subtle);
  width:100%;
}
.result-item:hover,.fav-item:hover,.queue-item:hover{background:var(--surface-hover)}
.result-item.is-playing,.fav-item.is-playing,.queue-item.is-playing{
  background:var(--surface-hover);
  border-radius:16px;
}

/* ====== Equalizer ====== */
.eq{ --bar:2px; --gap:2px; display:none; align-items:flex-end; gap:var(--gap);
  width:calc((var(--bar)*3) + (var(--gap)*2)); height:12px; margin-left:6px; }
.eq span{ width:var(--bar); height:45%; border-radius:2px;
  background:linear-gradient(to top,var(--accent),var(--accent-light));
  animation:eqBar 1s ease-in-out infinite; transform-origin:bottom center; opacity:.95; }
.eq span:nth-child(2){ height:80%; animation-delay:.12s; }
.eq span:nth-child(3){ height:60%; animation-delay:.24s; }
.result-item.is-playing .eq, .fav-item.is-playing .eq, .queue-item.is-playing .eq{ display:inline-flex; }
.result-item.is-playing .title-text, .fav-item.is-playing .title-text, .queue-item.is-playing .title-text{ color: var(--accent-light); }
@keyframes eqBar{ 0%,100%{ transform:scaleY(.35);} 50%{ transform:scaleY(1);} }
@media (prefers-reduced-motion: reduce){ .eq span{ animation:none; } }

/* Miniaturas */
.thumb-wrap{position:relative;width:56px;height:56px;flex:0 0 56px}
.thumb{width:56px;height:56px;border-radius:12px;object-fit:cover;border:2px solid rgba(255,255,255,.08)}
html[data-theme="light"] .thumb{ border-color:#e5e7eb; }

/* Botón play sobre thumb */
.card-play{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  width:40px;height:40px;border-radius:50%;border:none;display:grid;place-items:center;color:#fff;background:rgba(0,0,0,.55);padding:0;
  opacity: 0; transition: var(--fast);
}
.result-item:hover .card-play, .fav-item:hover .card-play, .queue-item:hover .card-play { opacity: 1; }
.card-play .i-pause{display:none}
.is-playing .card-play .i-play{display:none}
.is-playing .card-play .i-pause{display:block}
.is-playing .card-play { opacity: 1; }

/* Meta texto */
.meta{min-width:0;flex:1}
.title-line{display:flex;align-items:center;gap:10px;min-width:0}
.title-text{font-weight:600;font-size:var(--title-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.subtitle{font-size:var(--subtitle-size);color:var(--text-secondary);margin-top:4px}

/* Acciones / tres puntitos */
.actions{display:flex;gap:6px;margin-left:auto}
.icon-btn{width:40px;height:40px;border-radius:12px;border:none;background:transparent;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0}
.icon-btn.more, .icon-btn.more svg, .icon-btn.more path{color:var(--dots)!important;fill:var(--dots)!important}

/* ====== PLAYLISTS ====== */
.pl-list{ display:flex; flex-direction:column; gap:10px; }
.pl-item{
  display:flex; align-items:center; gap:12px;
  background:var(--surface); padding:10px 12px; border-radius:14px; border:1px solid var(--border-subtle);
  transition: var(--fast);
}
.pl-item:hover{ background:var(--surface-hover); border-color:var(--border); transform: translateY(-1px); }
.pl-item.is-playing { border-color: var(--accent); background: var(--surface-hover); }
.pl-meta{ display:flex; align-items:center; gap:12px; min-width:0; flex:1; }
.pl-thumb{
  width:48px; height:48px; border-radius:50%; object-fit:cover; display:block;
  background:var(--surface-elevated); border:2px solid rgba(255,255,255,.08);
}
html[data-theme="light"] .pl-thumb{ border-color:#e5e7eb; }
.pl-item .more{ margin-left:auto; }
.pl-meta .title-text{ font-weight:600; font-size:var(--title-size); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.pl-meta .subtitle{ margin-top:2px; font-size:var(--subtitle-size); color:var(--text-secondary); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* ===== HERO Favoritos ===== */
.fav-hero{
  position: sticky;
  top: var(--side-pad);
  z-index: 10;
  width: 100%;
  --hero-big: clamp(200px, 42vh, 360px);
  --hero-small: 120px;
  height: calc(var(--hero-big) - (var(--hero-big) - var(--hero-small)) * var(--hero-t, 0));
  background: var(--surface) center/cover no-repeat;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.08);
  margin-bottom: 12px;

  /* Anti-vibración */
  will-change: height, transform, border-radius;
  transform: translateZ(0);
  backface-visibility: hidden;
  contain: paint;
}
.fav-hero::before{
  content:"";position:absolute;inset:0;border-radius:inherit;
  background:linear-gradient(to top,rgba(8,9,12,.9)0%,rgba(8,9,12,.5)40%,rgba(8,9,12,0)100%);
}
.fav-hero-text{
  position:absolute; left:16px; right:16px; bottom:12px; z-index:1; color:#fff;
  opacity: calc(1 - var(--hero-t, 0) * 2);
}

/* ===== Reproductor (Header pegado que también achica) ===== */
.player-header-sticky {
  position: sticky;
  top: var(--side-pad);
  z-index: 11;
  background: var(--bg);
  padding-bottom: 16px;
}

.np-hero{
  width: min(420px, 90vw);
  margin-left: auto;
  margin-right: auto;
  --hero-big: clamp(260px, 56vw, 420px);
  --hero-small: 160px;
  height: calc(var(--hero-big) - (var(--hero-big) - var(--hero-small)) * var(--hero-t, 0));
  aspect-ratio: 1/1;
  background:var(--surface) center/cover no-repeat;
  border-radius: 22px;
  box-shadow: 0 10px 30px rgba(0,0,0,.2);

  /* Anti-vibración */
  will-change: height, transform, border-radius;
  transform: translateZ(0);
  backface-visibility: hidden;
  contain: paint;
}

.np-meta{text-align:center; padding: 0 10px; margin: 16px 0 20px;}
.np-title{font-size:18px;font-weight:700;margin:6px 0 4px}
.np-sub{font-size:13px}

/* Controles Player */
.player-controls { display: flex; flex-direction: column; align-items: center; gap: 20px; width: 100%; max-width: 500px; margin: 0 auto;}
.time-control { display: flex; align-items: center; gap: 12px; width: 100%; font-size: 12px; color: var(--text-secondary); }
.time-control input[type="range"] { flex: 1; }
.buttons-control { display: flex; align-items: center; justify-content: center; gap: 16px; width: 100%; }

.icon-btn-player { background: transparent; border: none; color: var(--text-secondary); cursor: pointer; padding: 8px; border-radius: 50%; display: grid; place-items: center; transition: var(--fast); }
.icon-btn-player:hover { color: var(--text-primary); background: var(--surface-hover); }
.icon-btn-player.active { color: var(--accent); }

.np-play{
  width:72px; height:72px; border-radius:50%; border:none; display:grid; place-items:center; color:#fff;
  background:linear-gradient(135deg,var(--accent),var(--accent-hover));box-shadow:0 12px 32px rgba(239,68,68,.35);
  transform: scale(calc(1 - 0.2 * var(--hero-t, 0)));
}
.np-play .i-pause{display:none}.np-play.playing .i-play{display:none}.np-play.playing .i-pause{display:block}

/* Input Range */
input[type="range"]{
  -webkit-appearance: none; appearance: none;
  width: 100%; height: 6px; background: var(--track-bg);
  border-radius: 3px; outline: none; opacity: 0.7; transition: opacity .2s;
}
input[type="range"]:hover{ opacity: 1; }
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none; appearance: none;
  width: 16px; height: 16px; background: var(--accent-light); cursor: pointer;
  border-radius: 50%; border: 3px solid var(--dock-bg);
}
html[data-theme="light"] input[type="range"]::-webkit-slider-thumb{ border-color:#fff; }

/* Cola del reproductor */
.queue-panel{margin-top: 12px;}

/* Section headers */
.section-head, .home-head { padding: 0; margin: 10px 0; }
#view-playlists .section-head { padding-left: var(--side-pad); padding-right: var(--side-pad); }

/* Mini-player unido a la barra inferior */
.seek-dock{
  position:fixed;left:0;right:0;bottom:var(--nav-h);z-index:70;
  background:var(--dock-bg);
  border-top:1px solid var(--border-subtle);
  padding:8px 12px;
  box-shadow:0 -4px 12px rgba(0,0,0,.18);
  transform: translateY(120%);
  transition: transform .4s cubic-bezier(.4,0,.2,1);
}
.seek-dock.show { transform: translateY(0); }

.mini-now{display:flex;align-items:center;gap:12px;}
.mini-thumb{width:44px;height:44px;border-radius:8px;object-fit:cover;border:2px solid var(--border-subtle); flex-shrink: 0;}
.mini-content-wrapper { flex: 1; min-width: 0; display: flex; flex-direction: column; gap: 4px; }
.mini-meta { flex: 1; min-width: 0; cursor: pointer; }
#miniTitle { font-size: 13px; font-weight: 600; }
#miniAuthor { font-size: 11px; }

.mini-progress { display: flex; align-items: center; gap: 8px; font-size: 10px; color: var(--text-muted); }
.seek-bar-mini { height: 4px; }
.seek-bar-mini::-webkit-slider-thumb { width: 10px; height: 10px; border: none; }

.mini-btn{
  width:42px;height:42px;aspect-ratio:1/1; padding:0;
  border:none;border-radius:50%;display:grid;place-items:center;
  background:linear-gradient(135deg,var(--accent),var(--accent-hover));color:#fff;
  flex-shrink: 0;
}
.mini-btn .i-pause{display:none}.mini-btn.playing .i-play{display:none}.mini-btn.playing .i-pause{display:block}

/* ===== Menú de los 3 puntitos (Sheet) ===== */
.sheet{position:fixed; inset:0; display:none; z-index:1300; background:rgba(8,9,12,.55); backdrop-filter:blur(6px);}
.sheet.show{ display:block; }
.sheet-content{
  position:absolute; left:0; right:0; bottom:0;
  background:rgba(26,28,36,.96);
  border-top-left-radius:18px; border-top-right-radius:18px;
  border:1px solid rgba(255,255,255,.1); border-bottom:none;
  padding:12px var(--side-pad) calc(12px + var(--safe));
  box-shadow:0 -12px 40px rgba(0,0,0,.5);
}
html[data-theme="light"] .sheet-content{ background:#ffffff; border-color:var(--border); }
.sheet-title{ font-weight:700; margin:6px 2px 8px; }
.sheet-list{ display:flex; flex-direction:column; gap:8px; max-height:40vh; overflow:auto; }
.sheet-item{
  width:100%; text-align:left; background:var(--surface);
  color:var(--text-primary); border:1px solid var(--border-subtle);
  padding:12px; border-radius:12px; margin:8px 0;
  cursor:pointer; transition:var(--fast);
}
.sheet-item:hover{ background:var(--surface-hover); border-color:var(--border); }
.sheet-item.ghost{ background:transparent; color:var(--text-secondary); border:1px solid var(--border-subtle); }
.sheet-item.ghost:hover{ border-color:var(--text-secondary); }
.sheet-item.danger{ background:rgba(127,29,29,.15); border-color:#7f1d1d; color:#fca5a5; }
html[data-theme="light"] .sheet-item.danger { color: #b91c1c; }
.sheet-row{ display:flex; gap:8px; margin-top:8px; }
.sheet-row input{
  flex:1; padding:10px 12px; border-radius:10px; border:1px solid var(--border-subtle);
  background:var(--surface); color:var(--text-primary);
}

/* Botón “Nueva / Crear” */
.pill{ padding:9px 14px; border-radius:999px; border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.08); color:#fff; font-weight:600; cursor:pointer; transition:var(--fast); }
html[data-theme="light"] .pill{ border-color:#e5e7eb; background:#f8fafc; color:#0f172a; }
.pill:hover{ transform:translateY(-1px); }

/* Barra inferior */
.bottom-nav{
  position:fixed;left:0;right:0;bottom:0;z-index:80;height:var(--nav-h);
  padding:6px 8px max(6px,var(--safe)); background:var(--dock-bg);
  border-top:1px solid var(--border-subtle);
  display:grid;grid-template-columns:repeat(4,1fr);gap:6px;
}

/* Iconos nav */
.nav-btn{ background:transparent; border:none; color:var(--nav-ink);
  display:flex;flex-direction:column;align-items:center;justify-content:center; gap:4px;border-radius:12px;padding:6px 0; cursor:pointer; transition:var(--fast); }
.nav-btn svg{width:22px;height:22px}
.nav-btn svg, .nav-btn path{ fill:currentColor !important; stroke:none !important; }
.nav-btn span{font-size:11px}
.nav-btn:hover{ color:var(--nav-ink-hover); }
.nav-btn.active{ color:var(--nav-ink-active); background: var(--surface); }
.nav-btn:active{transform:scale(.96)}

/* Esconder YouTube */
#yt-holder,#player,#player iframe{
  position:absolute!important;width:1px!important;height:1px!important;left:-9999px!important;top:-9999px!important;opacity:0!important;pointer-events:none!important;z-index:-1!important;
}

/* ====== Home grid ====== */
.home-section{ margin-bottom: 10px; }
.home-head{ display:flex; align-items:flex-end; justify-content:space-between; gap:10px; margin: 0 0 8px; }
.home-title{ margin:0; font-size:16px; font-weight:700; }
.home-sub{ margin:0; font-size:12px; color:var(--text-secondary); }
.home-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap:12px; }
.home-card{
  position:relative; border-radius:14px; overflow:hidden;
  background:var(--surface); border:1px solid var(--border-subtle);
  cursor:pointer; transition:var(--fast); aspect-ratio:1/1;
  opacity: 0; transform: translateY(20px) scale(0.98);
  animation: card-appear .6s cubic-bezier(.4,0,.2,1) forwards;
}
@keyframes card-appear{ to{ opacity: 1; transform: translateY(0) scale(1);} }
.home-card:hover{ transform:translateY(-2px) scale(1.02); background:var(--surface-hover); border-color:var(--border); }
.home-card img{ width:100%; height:100%; object-fit:cover; display:block; }
.home-card::after{ content:""; position:absolute; inset:0;
  background:linear-gradient(to top, rgba(8,9,12,.85) 0%, rgba(8,9,12,.2) 60%, rgba(8,9,12,0) 100%); }
.home-card .home-meta{ position:absolute; left:10px; right:10px; bottom:8px; z-index:1; }
.home-card .home-title-text{ font-weight:700; font-size:13px; margin:0 0 2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.home-card .home-subtitle{ font-size:11px; color:var(--text-secondary); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* Responsive */
@media (max-width:480px){
  :root{--side-pad:16px}
  .nav-btn svg{width:20px;height:20px}
  .home-grid{ grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
  .buttons-control { gap: 8px; }
  .np-play { width: 64px; height: 64px; }
}

/* Color base exacto del documento */
html, body { background-color: var(--bg); }


/* ====== Recommended Playlist Card ====== */
#homeGrid {
  /* Ensure it can contain the single large card */
  grid-template-columns: 1fr;
  max-width: 500px;
  margin: 0 auto;
}

.recommended-playlist-card {
  position: relative;
  width: 100%;
  aspect-ratio: 1 / 1;
  border-radius: var(--radius);
  overflow: hidden;
  cursor: pointer;
  transform: translateZ(0);
  transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
  border: 1px solid var(--border-subtle);
  opacity: 0;
  transform: translateY(20px) scale(0.98);
  animation: card-appear .6s cubic-bezier(.4,0,.2,1) forwards;
}

.recommended-playlist-card:hover {
  transform: scale(1.03);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.collage-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  width: 100%;
  height: 100%;
  background-color: var(--surface);
}

.collage-container img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.recommended-playlist-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 16px;
  background: linear-gradient(to top, rgba(8,9,12,0.95) 0%, rgba(8,9,12,0.5) 50%, transparent 100%);
  color: #fff;
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}

.recommended-playlist-meta {
  z-index: 1;
}

.recommended-playlist-title {
  font-size: 1.2rem;
  font-weight: 700;
  margin: 0 0 8px;
  line-height: 1.2;
}

.creator-line {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.spotify-logo {
  width: 16px;
  height: 16px;
  color: #f8fafc; /* Make it white-ish */
}
